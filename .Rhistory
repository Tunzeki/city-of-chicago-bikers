getwd()
setwd("C:/Users/HP/Documents/web-apps/coursera/google-data-analytics/portfolio")
getwd()
install.packages("tidyverse")
install.packages("xtable")
library(tidyverse)
library(xtable)
library(knitr)
jan_2022 <- read.csv('2022-divvy-tripdata/202201-divvy-tripdata.csv')
feb_2022 <- read.csv('2022-divvy-tripdata/202202-divvy-tripdata.csv')
mar_2022 <- read.csv('2022-divvy-tripdata/202203-divvy-tripdata.csv')
colnames(jan_2022)
colnames(feb_2022)
colnames(mar_2022)
rm(jan_2022, feb_2022, mar_2022)
cyclistic <- list.files(path='2022-divvy-tripdata', full.names = TRUE) %>%
lapply(read_csv) %>%
bind_rows
head(cyclistic)
str(cyclistic)
cbind(
lapply(
lapply(cyclistic, is.na), sum
)
)
table(cyclistic$rideable_type)
filter(cyclistic, ended_at < started_at)
filter(cyclistic, ended_at == started_at)
cyclistic_v02 <- filter(cyclistic, ended_at >= started_at)
table(cyclistic_v02$member_casual)
cyclistic_v02 <- cyclistic_v02 %>%
mutate(
ride_length = seconds_to_period(ended_at - started_at),
day_of_week = wday(started_at, label = TRUE),
month_of_year = month(started_at, label = TRUE, abbr = TRUE),
.after = ended_at
)
write_csv(data.frame(
table(cyclistic_v02$member_casual)
),
file = "riders.csv")
# Do descriptive statistics for each rider type
aggregate(ride_length ~ member_casual, data = cyclistic_v02, summary)
summary_stat <- data.frame(
Rider = c("Casual Rider", "Annual Member"),
Minimum = c("0S", "0S"),
Median = c("12M 54S", "7M 46S"),
Mean = c("31M 20S", "11M 49S"),
Maximum = c("23d 20H 34M 4S", "1d 1H 59M 54S")
)
xtable(summary_stat, caption = "Descriptive statistics for each rider type")
avg_ride_duration_per_day <- aggregate(ride_length ~ member_casual + day_of_week, data = cyclistic_v02, mean)
kable(avg_ride_duration_per_day, caption = "Daily average trip duration")
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(average_duration = mean(as.numeric(ride_length))) %>%
ggplot(aes(x = day_of_week, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Daily Average Trip Duration of City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Rider Category") +
xlab("Day of the Week") +
ylab("Minutes")
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = day_of_week, y = number_of_rides, fill = member_casual)) +
geom_bar(position = "dodge")
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = day_of_week, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge")
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = day_of_week, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge")
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(average_duration = mean(as.numeric(ride_length)))/60 %>%
ggplot(aes(x = day_of_week, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Daily Average Trip Duration of City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Rider Category") +
xlab("Day of the Week") +
ylab("Minutes")
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(average_duration = mean(as.numeric(ride_length))/60) %>%
ggplot(aes(x = day_of_week, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Daily Average Trip Duration of City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Rider Category") +
xlab("Day of the Week") +
ylab("Minutes")
summary_stat_table <- xtable(summary_stat, caption = "Descriptive statistics for each rider type")
print(summary_stat_table, type = "html")
# Do descriptive statistics for each rider type
aggregate(ride_length ~ member_casual, data = cyclistic_v02, summary)
summary_stat <- data.frame(
Rider = c("Casual Rider", "Annual Member"),
Minimum = c("0S", "0S"),
Median = c("12M 54S", "7M 46S"),
Mean = c("31M 20S", "11M 49S"),
Maximum = c("23d 20H 34M 4S", "1d 1H 59M 54S")
)
kable(summary_stat, caption = "Descriptive statistics for each rider type")
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(average_duration = mean(as.numeric(ride_length))/60) %>%
ggplot(aes(x = day_of_week, y = average_duration, fill = member_casual)) +
geom_col(position = "stack") +
labs(title = "Daily Average Trip Duration of City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Day of the Week") +
ylab("Minutes")
avg_ride_duration_per_day <- aggregate(ride_length ~ member_casual + day_of_week, data = cyclistic_v02, mean)
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(average_duration = mean(as.numeric(ride_length))/60)
kable(avg_ride_duration_per_day, caption = "Daily average trip duration")
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(average_duration = mean(as.numeric(ride_length))/60)
asd <- cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(average_duration = mean(as.numeric(ride_length))/60)
asd
asd
avg_ride_duration_per_day <- aggregate(as.numeric(ride_length) ~ member_casual + day_of_week, data = cyclistic_v02, mean)
kable(avg_ride_duration_per_day, caption = "Daily average trip duration")
avg_ride_duration_per_day <- aggregate(as.numeric(ride_length)/60 ~ member_casual + day_of_week, data = cyclistic_v02, mean)
kable(avg_ride_duration_per_day, caption = "Daily average trip duration")
cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = month_of_year, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge")
cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = month_of_year, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Monthly Number of Rides Among City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Month") +
ylab("Ride")
cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = month_of_year, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Monthly Number of Rides Among City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Month") +
ylab("Ride")
cyclistic_v02 %>%
group_by(member_casual, rideable_type) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = rideable_type, y = number_of_rides, fill = member_casual)) +
geom_col(position = "stack") +
coord_flip() +
labs(title = "Bicycle Used During Trips",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Bicycle") +
ylab("Count")
cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = month_of_year, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Monthly Number of Rides Among City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Month") +
ylab("Ride")
cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n())
c <- cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n())
c
cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = month_of_year, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Monthly Number of Rides Among City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Month") +
ylab("Ride")
avg_ride_duration_per_day <- aggregate(as.numeric(ride_length)/60 ~ member_casual + day_of_week, data = cyclistic_v02, mean)
rename(avg_ride_duration_per_day,
Rider = member_casual,
`Day of Week` = day_of_week,
`Mean (in minutes)` = `as.numeric(ride_length)/60`)
kable(avg_ride_duration_per_day, caption = "Daily average trip duration")
avg_ride_duration_per_day <- aggregate(as.numeric(ride_length)/60 ~ member_casual + day_of_week, data = cyclistic_v02, mean)
avg_ride_duration_per_day <- rename(avg_ride_duration_per_day,
Rider = member_casual,
`Day of Week` = day_of_week,
`Mean (in minutes)` = `as.numeric(ride_length)/60`)
kable(avg_ride_duration_per_day, caption = "Daily average trip duration")
cyclistic_v02$member_casual[cyclistic_v02$member_casual == "casual"] <- "Casual Rider"
cyclistic_v02$member_casual[cyclistic_v02$member_casual == "member"] <- "Annual Member"
cyclistic_v02 %>%
group_by(member_casual, day_of_week) %>%
summarise(average_duration = mean(as.numeric(ride_length))/60) %>%
ggplot(aes(x = day_of_week, y = average_duration, fill = member_casual)) +
geom_col(position = "stack") +
labs(title = "Daily Average Trip Duration of City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Day of the Week") +
ylab("Minutes")
cyclistic_v02 %>%
group_by(member_casual, rideable_type) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = rideable_type, y = number_of_rides, fill = member_casual)) +
geom_col(position = "stack") +
coord_flip() +
scale_fill_manual(values = c("blue", "purple")) +
labs(title = "Bicycle Used During Trips",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Bicycle") +
ylab("Count")
cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = month_of_year, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") +
scale_fill_grey() +
labs(title = "Monthly Number of Rides Among City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Month") +
ylab("Ride")
cyclistic_v02 %>%
group_by(member_casual, month_of_year) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = month_of_year, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") +
scale_fill_grey() +
theme_minimal() +
labs(title = "Monthly Number of Rides Among City of Chicago Bikers",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Month") +
ylab("Ride")
cyclistic_v02 %>%
group_by(member_casual, rideable_type) %>%
summarise(number_of_rides = n()) %>%
ggplot(aes(x = rideable_type, y = number_of_rides, fill = member_casual)) +
geom_col(position = "stack") +
coord_flip() +
scale_fill_manual(values = c("blue", "purple")) +
theme_minimal() +
labs(title = "Bicycle Used During Trips",
subtitle = "Casual Riders vs Annual Members",
caption = "Data Source: Motivate Int'l Inc",
fill = "Riders") +
xlab("Bicycle") +
ylab("Count")
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
